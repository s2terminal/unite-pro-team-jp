---
import href from '../lib/url';

type Props = {
  siteName?: string;
  title?: string;
  description?: string;
  type?: 'website' | 'article' | string;
  noindex?: boolean;
  locale?: string;
  card?: 'summary_large_image' | 'summary';
  image?: string;
  // Canonical URL; デフォルトは現在のページのURL
  url?: string;
};

const {
  title,
  description,
  type = 'website',
  noindex = false,
  siteName,
  locale = 'ja_JP',
  image,
  url,
} = Astro.props as Props;

// Resolve canonical URL (absolute)
const canonical = url ?? Astro.url?.href ?? '';

// Resolve OGP image absolute URL
const imagePath = image ?? 'ogp.png';
const imageAbs = new URL(href(imagePath, { trailingSlash: false }), Astro.site ?? Astro.url).href;

const resolvedSiteName = siteName ?? 'Unite Pro Team JP';
const resolvedTitle = title ?? resolvedSiteName;
const resolvedDescription =
  description ?? '日本のポケモンユナイトプロチームの情報をまとめています。';
const resolvedType = type ?? 'website';
const resolvedNoindex = noindex ?? false;
const resolvedLocale = locale ?? 'ja_JP';
const resolvedTwitterCard = (Astro.props as Props).card ?? 'summary';
---

<>
  <title>{`${resolvedTitle} | ${resolvedSiteName}`}</title>
  <link rel="canonical" href={canonical} />
  <meta name="description" content={resolvedDescription} />
  <meta name="robots" content={resolvedNoindex ? 'noindex, nofollow' : 'index, follow'} />

  <meta property="og:title" content={`${resolvedTitle} | ${resolvedSiteName}`} />
  <meta property="og:description" content={resolvedDescription} />
  <meta property="og:type" content={resolvedType} />
  <meta property="og:url" content={canonical} />
  <meta property="og:site_name" content={resolvedSiteName} />
  <meta property="og:locale" content={resolvedLocale} />
  <meta property="og:image" content={imageAbs} />

  <meta name="twitter:card" content={resolvedTwitterCard} />
  <meta name="twitter:title" content={`${resolvedTitle} | ${resolvedSiteName}`} />
  <meta name="twitter:description" content={resolvedDescription} />
  <meta name="twitter:image" content={imageAbs} />
</>
